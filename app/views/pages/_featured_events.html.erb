<!-- app/views/home/_featured_events.html.erb -->
<% if events.present? %>

<h5 class="text-center text-muted mb-3 pt-5">Recently Posted Events</h5>

  <% events.each do |event| %>
    <div class="card event-card shadow-sm rounded-4 mb-3" style="background-color: #ffffff;"
         data-controller="event-card"
         data-event-card-url-value="<%= event_path(event) %>"
         data-action="click->event-card#goToEvent">

      <div class="card-body text-center p-3" style="cursor: pointer;">
        <div class="d-inline-block px-3 py-1 rounded-pill bg-primary text-white fw-semibold mb-2"
             style="font-size: 0.9rem; background: linear-gradient(90deg, #0d6efd, #4dabf7) !important;">
          <% st = event.starts_at_local; et = event.ends_at_local %>
          <% today_label = (st.to_date == st.time_zone.today) ? "Today" : st.strftime("%A, %b %-d") %>
          <i class="bi bi-clock me-1"></i>
          <%= today_label %> â€¢ 
          <%= st.strftime("%-I:%M %p") %> - 
          <%= et.strftime("%-I:%M %p") %>
        </div>
        <br>
        <small>
          <% if event.artist.present? %>
            <%= link_to event.artist.username, artist_path(event.artist),
                        class: "text-decoration-none",
                        onclick: "event.stopPropagation(); event.stopImmediatePropagation();" %>
            at
            <% if event.venue.present? %>
              <%= link_to event.venue.name, venue_path(event.venue),
                          class: "text-decoration-none",
                          onclick: "event.stopPropagation(); event.stopImmediatePropagation();" %>
            <% else %>
              <span class="text-muted">Unknown Venue</span>
            <% end %>
          <% else %>
            <span class="text-muted">
              <%= event.artist_name.presence || "Live Music" %> at
              <% if event.venue.present? %>
                <%= link_to event.venue.name, venue_path(event.venue),
                            class: "text-decoration-none",
                            onclick: "event.stopPropagation(); event.stopImmediatePropagation();" %>
              <% else %>
                Unknown Venue
              <% end %>
            </span>
          <% end %>
        </small>
      </div>
    </div>
  <% end %>
<% else %>

<% end %>
