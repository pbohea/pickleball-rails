<div class="container mt-5" style="max-width: 600px;">
  <h2 class="mb-4 text-center">Add New Venue</h2>

  <%= form_with model: @venue, local: true, class: "needs-validation" do |f| %>

    <% if @venue.errors.any? %>
      <div class="alert alert-danger">
        <h4><%= pluralize(@venue.errors.count, "error") %> prevented this venue from being saved:</h4>
        <ul>
          <% @venue.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="mb-3">
      <%= f.label :name, "Venue Name", class: "form-label" %>
      <%= f.text_field :name, class: "form-control", placeholder: "e.g. The Blue Note", required: true %>
    </div>

    <div class="mb-3">
      <%= f.label :category, class: "form-label" %>
      <%= f.select :category, Venue::CATEGORIES, {}, class: "form-select", required: true %>
    </div>

    <div class="mb-3">
      <%= f.label :website, "Website (optional)", class: "form-label" %>
      <%= f.text_field :website, class: "form-control", placeholder: "https://example.com" %>
    </div>

    <div class="mb-3" data-controller="image-preview">
      <%= f.label :image, "Profile Photo", class: "form-label" %>

      <div data-image-preview-target="container" class="mb-2 d-none">
        <img data-image-preview-target="preview" class="img-thumbnail" style="max-width: 300px;" />
      </div>

      <% if f.object.persisted? && f.object.image.attached? %>
        <div class="mb-2">
          <%= image_tag f.object.image.variant(resize_to_limit: [300, 300]).processed,
                alt: "#{f.object.name} photo",
                class: "img-thumbnail" %>
        </div>
      <% end %>

      <%= f.file_field :image,
        accept: "image/jpeg,image/png",
        class: "form-control",
        data: { image_preview_target: "input", action: "image-preview#previewImage" } %>
    </div>

    <div class="mb-3">
      <%= f.label :street_address, "Street Address", class: "form-label" %>
      <%= f.text_field :street_address, class: "form-control", placeholder: "123 Main St", required: true %>
    </div>

    <div class="mb-3">
      <%= f.label :city, class: "form-label" %>
      <%= f.text_field :city, class: "form-control", placeholder: "Chicago", required: true %>
    </div>

    <div class="mb-3">
      <%= f.label :state, class: "form-label" %>
      <%= f.text_field :state, class: "form-control", placeholder: "IL", maxlength: 2, required: true %>
    </div>

    <div class="mb-4">
      <%= f.label :zip_code, "ZIP Code", class: "form-label" %>
      <%= f.text_field :zip_code, class: "form-control", placeholder: "60614", required: true %>
    </div>

    <div class="d-grid">
      <%= f.submit "Create Venue", class: "btn btn-primary" %>
    </div>

  <% end %>
</div>
